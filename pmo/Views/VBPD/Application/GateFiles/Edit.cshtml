@model List<FileForm>

@{
    ViewData["Title"] = "Edit";
    Layout = "_VbpdProjectDetailLayout";
    int projectId = int.Parse(Helpers.GetRouteValue(Context.Request, "projectId"));
    int stageNumber = int.Parse(Helpers.GetRouteValue(Context.Request, "stageNumber"));
    var uploads = (List<dbModels.GateFile>)ViewBag.Uploaded;
}

<div class="actions-component">
    <div class="wrapper">
        <div class="header">
            <h1>Gate Files</h1>
        </div>
    </div>
</div>

@if (uploads.Count > 0) {
    <div class="list-component">
        <div class="wrapper">
            <div class="title">
                <div>Download</div>
                <div>Description</div>
                <div>Created</div>
                <div>Uploaded By</div>
                <div><!-- placeholder for delete actions --></div>
            </div>
            <div class="items">
                <div class="item">
                    @foreach (var upload in uploads) {
                        <div class="item-wrapper">
                            <a href="@upload.Url" target="_blank">
                                <i class="fas fa-download"></i>
                            </a>
                            <div>@upload.Description</div>
                            <div>@upload.CreateDate</div>
                            <div>@upload.ModifiedByUser</div>
                            <div class="actions">
                                <form method="post" action="/vbpd-projects/@projectId/stages/@stageNumber/gate-files/delete">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="fileid" value="@upload.Id" />
                                    <input type="hidden" name="url" value="@upload.Url" />
                                    <button type="submit" class="btn red"><i class="fas fa-trash-alt"></i></button>
                                </form>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
}


@if (Model.Count > 0) {
    <form class="form-component" enctype="multipart/form-data" method="post" action="/vbpd-projects/@projectId/stages/@stageNumber/gate-files/edit">
        @Html.AntiForgeryToken()
        <div class="wrapper">
            <div class="fields mh-300">
                @for (int i = 0; i < Model.Count; i++){
                    <input type="hidden" asp-for="@Model[i].TagId">
                    <input type="hidden" asp-for="@Model[i].TagDescription">
                    <div class="field">
                        <div class="label">@Model[i].TagDescription</div>
                        <input class="data" asp-for="@Model[i].File" />
                        <ul class="errors">
                            @Html.Partial("_FieldErrors", Model[i].File)
                        </ul>
                    </div>
                    <div class="field">
                        <div class="label">Description</div>
                        <input class="data" asp-for="@Model[i].Description" />
                        <ul class="errors">
                            @Html.Partial("_FieldErrors", Model[i].Description)
                        </ul>
                    </div>
                }
            </div>
            <div class="field">
                <input type="submit" class="data btn" value="Submit" />
            </div>
        </div>
    </form>
}
